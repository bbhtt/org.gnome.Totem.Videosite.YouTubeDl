id: org.gnome.Totem.Videosite.YouTubeDl
runtime: org.gnome.Totem
sdk: org.gnome.Sdk//3.38
build-extension: true
separate-locales: false
appstream-compose: false

build-options:
  env:
    PIP_TARGET: /app/lib/totem-pl-parser/YouTubeDl/site-packages

modules:
  - name: youtube-dl
    buildsystem: simple
    build-commands:
      - pip3 install .
    sources:
      - type: archive
        url: http://yt-dl.org/downloads/latest/youtube-dl-2020.11.01.1.tar.gz
        sha256: 7a62187bc9f91af42eb5c9c95652e350170a72dbbdac8c7d71a6aeb4885a901a
    cleanup:
      - 'etc/'
      - 'share/'

  - name: totem-pl-parser-youtube-dl
    buildsystem: simple
    build-commands:
      - install -Dm755 totem-ydl-parser.py ${FLATPAK_DEST}/bin/01-totem-pl-parser-videosite-youtube-dl
    sources:
      - type: git
        url: https://github.com/MathieuDuponchelle/totem-ydl-parser.git
        commit: 9d531edaa1ab37f59d736a7fa9a451e09a887077
