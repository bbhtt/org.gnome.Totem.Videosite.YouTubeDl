id: org.gnome.Totem.Videosite.YouTubeDl
runtime: org.gnome.Totem//stable
sdk: org.gnome.Sdk//3.38
build-extension: true
separate-locales: false
appstream-compose: false

build-options:
  env:
    PIP_TARGET: /app/lib/totem-pl-parser/YouTubeDl/site-packages

modules:
  - name: youtube-dl
    buildsystem: simple
    build-commands:
      - pip3 install .
    sources:
      - type: archive
        url: http://yt-dl.org/downloads/latest/youtube-dl-2020.11.12.tar.gz
        sha256: aeb00b2079c4711de7eea2a91f6923ebade84c5e985b0caeb47d572395d42831
    cleanup:
      - 'etc/'
      - 'share/'

  - name: totem-pl-parser-youtube-dl
    buildsystem: simple
    build-commands:
      - install -Dm755 totem-ydl-parser.py ${FLATPAK_DEST}/bin/01-totem-pl-parser-videosite-youtube-dl
    sources:
      - type: git
        url: https://github.com/MathieuDuponchelle/totem-ydl-parser.git
        commit: 9d531edaa1ab37f59d736a7fa9a451e09a887077
